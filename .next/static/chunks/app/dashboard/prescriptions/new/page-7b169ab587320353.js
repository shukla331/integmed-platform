(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[780],{1416:function(e,t,s){Promise.resolve().then(s.bind(s,866))},866:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(3827),r=s(4090),i=s(7907),n=s(826);function c(){let e=(0,i.useRouter)(),[t,s]=(0,r.useState)(""),[c,l]=(0,r.useState)([]),[d,o]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),[x,u]=(0,r.useState)(null),p=async e=>{if(e.preventDefault(),t.trim()){m(!0);try{let e=await n.Z.expandShorthand(t);l([...c,e]),s(""),await g([...c,e])}catch(e){var a,r;alert((null===(r=e.response)||void 0===r?void 0:null===(a=r.data)||void 0===a?void 0:a.detail)||"Failed to expand shorthand")}finally{m(!1)}}},g=async e=>{try{let t=await n.Z.checkInteractions({medications:e});u(t)}catch(e){console.error("Failed to check interactions:",e)}},y=e=>{let t=c.filter((t,s)=>s!==e);l(t),t.length>0?g(t):u(null)},f=async()=>{o(!0);try{let t=await n.Z.createPrescription({encounter_id:"temp-encounter-id",medications:c});await n.Z.signPrescription(t.id),alert("Prescription created and signed successfully!"),e.push("/dashboard")}catch(e){var t,s;alert((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to create prescription")}finally{o(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-4 flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-display font-bold text-primary-900",children:"New Prescription"}),(0,a.jsx)("button",{onClick:()=>e.back(),className:"text-gray-600 hover:text-gray-900",children:"← Back"})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Add Medication"}),(0,a.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("input",{type:"text",value:t,onChange:e=>s(e.target.value),placeholder:'Type shorthand (e.g., "Metf 1000 bd 30d")',className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:'\uD83D\uDCA1 Tip: "Metf 1000 bd 30d" = Metformin 1000mg, twice daily, 30 days'})]}),(0,a.jsx)("button",{type:"submit",disabled:h||!t.trim(),className:"w-full bg-primary-500 text-white py-3 rounded-lg font-medium hover:bg-primary-700 transition disabled:opacity-50",children:h?"Expanding...":"Add Medication"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Medications (",c.length,")"]}),0===c.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-400",children:[(0,a.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDC8A"}),(0,a.jsx)("p",{children:"No medications added yet"})]}):(0,a.jsx)("div",{className:"space-y-4",children:c.map((e,t)=>{var s;return(0,a.jsxs)("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-primary-300",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-primary-600 font-semibold mb-1",children:e.generic_name}),(0,a.jsxs)("div",{className:"font-medium",children:[(null===(s=e.brand_suggestions)||void 0===s?void 0:s[0])||"Generic"," ",e.strength]})]}),(0,a.jsx)("button",{onClick:()=>y(t),className:"text-red-500 hover:text-red-700",children:"✕"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm text-gray-600 mt-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Frequency:"})," ",e.frequency]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Duration:"})," ",e.duration_days," days"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Quantity:"})," ",e.quantity]})]}),e.instructions&&(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-2",children:["\uD83D\uDCDD ",e.instructions]})]},t)})})]}),c.length>0&&(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{onClick:()=>l([]),className:"flex-1 px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear All"}),(0,a.jsx)("button",{onClick:f,disabled:d,className:"flex-1 px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:d?"Creating...":"Sign & Create Prescription"})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:"\uD83D\uDEE1️ Safety HUD"}),x?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Safety Score"}),(0,a.jsxs)("div",{className:"text-3xl font-bold",children:[x.safety_score.toFixed(1),"/10"]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-2 rounded-full mt-2",children:(0,a.jsx)("div",{className:"h-2 rounded-full ".concat(x.safety_score>=8?"bg-green-500":x.safety_score>=6?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(10*x.safety_score,"%")}})})]}),x.interactions.length>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"text-sm font-semibold text-gray-700",children:"⚠️ Interactions Found"}),x.interactions.map((e,t)=>(0,a.jsxs)("div",{className:"p-3 rounded-lg border-l-4 ".concat("severe"===e.severity?"bg-red-50 border-red-500":"moderate"===e.severity?"bg-yellow-50 border-yellow-500":"bg-blue-50 border-blue-500"),children:[(0,a.jsxs)("div",{className:"text-sm font-medium",children:[e.drug1," + ",e.drug2]}),(0,a.jsx)("div",{className:"text-xs mt-1",children:e.description}),(0,a.jsxs)("div",{className:"text-xs mt-2 font-medium",children:["\uD83D\uDCA1 ",e.recommendation]})]},t))]}),0===x.interactions.length&&0===x.contraindications.length&&0===x.allergy_alerts.length&&(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg border-l-4 border-green-500",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-green-800",children:"✓ No interactions detected"}),(0,a.jsx)("div",{className:"text-xs text-green-600 mt-1",children:"Safe to prescribe"})]})]}):(0,a.jsx)("div",{className:"text-center py-4 text-gray-400",children:(0,a.jsx)("p",{className:"text-sm",children:"Add medications to check interactions"})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-4",children:"✓ NMC Compliance"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-green-500",children:"✓"}),(0,a.jsx)("span",{children:"Generic names in CAPITALS"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-green-500",children:"✓"}),(0,a.jsx)("span",{children:"Generic-first prescription"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-green-500",children:"✓"}),(0,a.jsx)("span",{children:"Digital signature ready"})]})]})]})]})]})})]})}},826:function(e,t,s){"use strict";var a=s(3107),r=s(146);let i="http://localhost:8000";class n{async initDoctorAuth(e){return(await this.client.post("/auth/doctor/init",{mobile:e,purpose:"login"})).data}async verifyDoctorAuth(e,t){let{access_token:s,refresh_token:a,user:i}=(await this.client.post("/auth/doctor/verify",{txn_id:e,otp:t})).data;return r.Z.set("access_token",s,{expires:1}),r.Z.set("refresh_token",a,{expires:7}),{user:i,access_token:s}}logout(){r.Z.remove("access_token"),r.Z.remove("refresh_token"),window.location.href="/login"}async getPatient(e){return(await this.client.get("/patients/".concat(e))).data}async createPatient(e){return(await this.client.post("/patients",e)).data}async createEncounter(e){return(await this.client.post("/encounters",e)).data}async updateEncounter(e,t){return(await this.client.patch("/encounters/".concat(e),t)).data}async expandShorthand(e){return(await this.client.post("/prescriptions/expand-shorthand",{shorthand:e})).data}async checkInteractions(e){return(await this.client.post("/prescriptions/check-interactions",e)).data}async createPrescription(e){return(await this.client.post("/prescriptions/draft",e)).data}async signPrescription(e){return(await this.client.post("/prescriptions/".concat(e,"/sign"))).data}async getHealthTimeline(e,t){return(await this.client.get("/clinical/health-graph/".concat(e),{params:t})).data}async requestConsent(e){return(await this.client.post("/abdm/consent-requests/init",e)).data}constructor(){this.client=a.Z.create({baseURL:"".concat(i,"/api/v1"),headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>{let t=r.Z.get("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){let t=r.Z.get("refresh_token");if(t)try{let{access_token:s}=(await a.Z.post("".concat(i,"/api/v1/auth/refresh"),{refresh_token:t})).data;if(r.Z.set("access_token",s),e.config)return e.config.headers.Authorization="Bearer ".concat(s),this.client.request(e.config)}catch(e){r.Z.remove("access_token"),r.Z.remove("refresh_token"),window.location.href="/login"}else window.location.href="/login"}return Promise.reject(e)})}}let c=new n;t.Z=c}},function(e){e.O(0,[568,971,69,744],function(){return e(e.s=1416)}),_N_E=e.O()}]);